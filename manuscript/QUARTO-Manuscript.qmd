---
title: ""
format: 
  docx:
    page-width: 10
    reference-doc: template.docx
editor: source
bibliography: resources/references.bib
citation-abbreviations: resources/medline-abbreviations.json
csl: resources/ama.csl
execute:
  echo: false
  warning: false
project: 
  execute-dir: project
crossref: 
  fig-title: Fig
filters:
  - resources/docx-landscape.lua
---

```{r render-for-colleagues, eval = FALSE, include = FALSE}
#' WHEN READY TO RENDER VERSION FOR SHARING WITH COLLEAGUES USE THIS CODE 
#' TO APPEND A DATE TO THE OUTPUT
save <- FALSE
if (save == TRUE) {
file_name <- paste0(Sys.Date(),"_draft_NPA-MEPS-comparison-manuscript.docx")

quarto::quarto_render('manuscript/QUARTO-Manuscript.qmd', output_file = file_name)

file.rename(from = here::here(file_name),
            to = here::here('manuscript', 'output', file_name))
}
```

```{r}
library(targets)
library(tidyverse)
library(gt)
library(JakeR)
library(patchwork)
tar_config_set(store = here::here('_targets/'))
tar_load(pooled_dat)
tar_load(meps_iqvia)

```

```{r reporting-functions}
comparePercents <- function(data, prescription, which.first) {
  if (which.first == 'MEPS') {
    data[data$Prescription == prescription, 'MEPS'] - data[data$Prescription == prescription, 'IQVIA']
  } else {
    data[data$Prescription == prescription, 'IQVIA'] - data[data$Prescription == prescription,  'MEPS']
  }
  
}
```

```{r barplot}
meps_iqvia <- meps_iqvia |>
  mutate(insulin_indicator = case_when(
    str_detect(Prescription, 'Insulin -') ~ 'Insulin',
    TRUE ~ 'Not insulin'
  ))

insulin_data <- meps_iqvia |>
  filter(insulin_indicator == 'Insulin')
not_insulin_data <- meps_iqvia |>
  filter(insulin_indicator != 'Insulin')

wide_insulin_data <- insulin_data |>
  filter(stratifier == 'Overall') |>
  mutate(Prescription = str_remove_all(Prescription, 'Insulin - ')) |>
  mutate(Prescription = factor(
    Prescription,
    levels = c(
      'Bolus/Human',
      'Bolus/Analog',
      'Basal/Human',
      'Basal/Analog',
      'Pre-mixed',
      'Pre-mixed/Human',
      'Pre-mixed/Analog',
      'Insulin/Unknown'
    )
  )) |>
  mutate(total = sum(Number, na.rm = TRUE), .by = data) |>
  mutate(Percent = (Number / total) * 100) |> 
  pivot_wider(names_from = 'data',
              values_from = 'Percent',
              id_cols = c(Prescription, stratifier, group))

wide_not_insulin <- not_insulin_data |>
  filter(stratifier == 'Overall') |>
  mutate(total = sum(Number, na.rm = TRUE), .by = data) |>
  mutate(Percent = (Number / total) * 100) |>
  mutate(Prescription = factor(
    Prescription,
    levels = c(
      'All insulins',
      'Biguanides',
      'Sulfonylureas',
      'TZD',
      'DPP-4i',
      'GLP-1RA',
      'SGLT2i',
      'Unknown'
    )
  ))|> 
  pivot_wider(names_from = 'data',
              values_from = 'Percent',
              id_cols = c(Prescription, stratifier, group))

```

```{r heatmap}

wide_meps_iqvia <- meps_iqvia |> 
  filter(stratifier != 'Prescribing medical specialty') |> 
  pivot_wider(names_from = data,
              values_from = c(Number, Percent, PercentLL, PercentUL, Flags),
              id_cols = c(Prescription, stratifier, group)) |> 
  select(-PercentLL_IQVIA, -PercentUL_IQVIA)

total_non_insulin_iqvia <- sum(
  wide_meps_iqvia$Number_IQVIA[wide_meps_iqvia$stratifier == 'Overall' & !str_detect(wide_meps_iqvia$Prescription, 'Insulin -')],
  na.rm = TRUE
)

total_non_insulin_meps <- sum(
  wide_meps_iqvia$Number_MEPS[wide_meps_iqvia$stratifier == 'Overall' & !str_detect(wide_meps_iqvia$Prescription, 'Insulin -')],
  na.rm = TRUE
)

total_insulin_iqvia <- wide_meps_iqvia |> 
  filter(stratifier == 'Overall',
         Prescription == 'All insulins') |> 
  pull(Number_IQVIA)

total_insulin_meps <- wide_meps_iqvia |> 
  filter(stratifier == 'Overall',
         Prescription == 'All insulins') |> 
  pull(Number_MEPS)

wide_meps_iqvia <- wide_meps_iqvia |> 
  mutate(noninsulin_total_IQVIA = total_non_insulin_meps,
         noninsulin_total_MEPS = total_non_insulin_meps,
         insulin_total_IQVIA = total_insulin_iqvia,
         insulin_total_MEPS = total_insulin_meps,
         Percent_IQVIA = case_when(stratifier == 'Overall' & str_detect(Prescription, 'nsulin') ~ 
                                     Number_IQVIA / insulin_total_IQVIA * 100,
                                   stratifier == 'Overall' & !str_detect(Prescription, 'nsulin') ~
                                     Number_IQVIA / noninsulin_total_IQVIA * 100,
                                   TRUE ~ Percent_IQVIA),
         Percent_MEPS = case_when(stratifier == 'Overall' & str_detect(Prescription, 'nsulin') ~ 
                                     Number_MEPS / insulin_total_MEPS * 100,
                                   stratifier == 'Overall' & !str_detect(Prescription, 'nsulin') ~
                                     Number_MEPS / noninsulin_total_MEPS * 100,
                                   TRUE ~ Percent_MEPS)
         ) |> 
  mutate(number_diff = Number_IQVIA - Number_MEPS,
         perc_diff = Percent_IQVIA - Percent_MEPS) |> 
  mutate(across(c(number_diff, perc_diff), ~case_when(!is.na(Flags_MEPS) ~ NA,
                                                      TRUE ~ .x)),
         across(c(PercentLL_MEPS, PercentUL_MEPS), ~as.numeric(.x))) |> 
  mutate(perc_diff_between = between(Percent_IQVIA, PercentLL_MEPS, PercentUL_MEPS))
  
comparison_table <- wide_meps_iqvia |> 
  mutate(number_diff = round(number_diff, digits = -3)) |> 
  pivot_wider(names_from = Prescription,
              values_from = perc_diff,
              id_cols = c(stratifier, group))


heatmap_data <- wide_meps_iqvia |>
  filter(group != 'Unknown') |>
  mutate(Group = case_when(stratifier == 'Overall' ~ 'Overall',
                           TRUE ~ paste0(stratifier, ': ', group))) |> 
  mutate(Group = factor(Group,
                        levels = c('Overall',
                                   'Age: < 10',
                                   'Age: 10 - 19',
                                   'Age: 20 - 39',
                                   'Age: 40 - 59',
                                   'Age: 60 - 74',
                                   'Age: 75+',
                                   'Sex: Female',
                                   'Sex: Male',
                                   'Race: Asian/not Hispanic',
                                   'Race: Black/not Hispanic',
                                   'Race: Hispanic',
                                   'Race: Other Race/not Hispanic',
                                   'Race: White/not Hispanic',
                                   'Education: Less than high school',
                                   'Education: High school',
                                   'Education: Greater than high school',
                                   'Insurance: 3rd party',
                                   'Insurance: Any private',
                                   'Insurance: Medicaid',
                                   'Insurance: Medicare Part D',
                                   'Insurance: Public only',
                                   'Insurance: Cash',
                                   'Insurance: Uninsured',
                                   'Copay: $0',
                                   'Copay: >$0-$10',
                                   'Copay: >$10-$20',
                                   'Copay: >$20-$30',
                                   'Copay: >$30-$75',
                                   'Copay: >$75',
                                   'Poverty: High income (>= 400% of poverty line)',
                                   'Poverty: Middle income (200% - 399% of poverty line)',
                                   'Poverty: Low income (100% - <200% of poverty line)',
                                   'Poverty: Poor (<100% of poverty line)'))) |> 
  mutate(Prescription = str_remove(Prescription, 'Insulin - ')) |> 
  mutate(Prescription = factor(Prescription,
                                            levels = c('Bolus/Human',
                                                       'Bolus/Analog',
                                                       'Basal/Human',
                                                       'Basal/Analog',
                                                       'Pre-mixed',
                                                       'Pre-mixed/Human',
                                                       'Pre-mixed/Analog',
                                                       'Insulin/Unknown',
                                                       'All insulins',
                                                       'Biguanides',
                                                       'Sulfonylureas',
                                                       'TZD',
                                                       'DPP-4i',
                                                       'GLP-1RA',
                                                       'SGLT2i',
                                                       'Unknown'))) |>
  filter(stratifier %nin% c('Race', 'Poverty', 'Education'),
         group %nin% c('< 10', '10 - 19')) |> 
  mutate(color = ifelse(perc_diff < -9 | perc_diff > 9, 'white', 'black'),
         insulin_indicator = case_when(Prescription %in% c('Bolus/Human',
                                                       'Bolus/Analog',
                                                       'Basal/Human',
                                                       'Basal/Analog',
                                                       'Pre-mixed',
                                                       'Pre-mixed/Human',
                                                       'Pre-mixed/Analog',
                                                       'Insulin/Unknown',
                                                       'All insulins') ~ 'insulin',
                                       TRUE ~ 'not insulin'))
heatmap <- heatmap_data |>
  filter(!str_detect(Prescription, 'Unknown')) |> 
  # Alter diff coding a bit without changing labels to get the color scales to look a bit better
  mutate(perc_diff_adj = case_when(perc_diff > 15 ~ 15,
                                   perc_diff < -15 ~ -15,
                                   TRUE ~ perc_diff),
         perc_diff_label = specifyDecimal(perc_diff, 1),
         perc_diff_label = case_when(
           perc_diff_between == FALSE & Prescription == 'All insulins' & stratifier == 'Overall' ~ perc_diff_label,
           perc_diff_between == FALSE ~ paste0(perc_diff_label, '*'),
                                     TRUE ~ perc_diff_label)) |> 
  group_split(insulin_indicator) |>
  map(
    ~ ggplot(.x, aes(
      y = Group,
      x = Prescription,
      fill = perc_diff_adj
    )) +
      geom_tile() +
      colorspace::scale_fill_continuous_diverging(
        palette = 'Purple-Green',
        breaks = c(15, 0,-15),
        labels = c('+\n(NPA higher)',
                   '0',
                   '-\n(MEPS higher)'),
        limits = c(-15, 15)
      ) +
      scale_x_discrete(position = 'top',
                       expand = c(0, 0)) +
      scale_y_discrete(limits = rev,
                       expand = c(0, 0)) +
      geom_text(aes(
        label = perc_diff_label,
        color = color
      ),
      show.legend = FALSE) +
      scale_color_manual(values = c('black', 'white')) +
      labs(fill = 'Difference in percentage estimates\n(NPA % - MEPS %)') +
      theme(legend.position = 'bottom',
            axis.text = element_text(color = 'black'))
  )

wrapped_heatmap <- heatmap[[1]] / heatmap[[2]] +
  plot_layout(axes = 'collect',
              guides = 'collect') +
  plot_annotation(tag_level = 'A') &
  theme(legend.position = 'bottom')
```

**Prescriptions for Antihyperglycemic Medication, United States
2020–2021**

Jacob T. Wittman^1^, PhD, Maribeth C. Lovegrove^2^, MPH, Kai McKeever
Bullard^1^, PhD MPH, Sola Han^1^, PhD PharmD, Andrew I. Geller^2^, MD,
Osatohamwen I. Idubor^1^, MD MHS, Yu Wang^1^, PhD, Stephen R. Benoit^1^,
MD MPH

^1^Division of Diabetes Translation, Centers for Disease Control and
Prevention, Atlanta, GA, United States

^2^Division of Healthcare Quality Promotion, Centers for Disease Control
and Prevention, Atlanta, GA, United States

Corresponding Author: Jacob T. Wittman, ugv4\@cdc.gov, 770-488-3533

Disclaimer: The findings and conclusions in this report are those of the
authors and do not necessarily represent the official position of the
Centers for Disease Control and Prevention.

Keywords:

Word Count: 4095 words

Number of tables and figures: 4

\pagebreak

# Abstract (202 words, limit 250)

**Objective:** To estimate the prevalence of antihyperglycemic
medication prescriptions in the U.S. during 2020-2021 using data from
retail pharmacies and household surveys.

**Research Design and Methods:** We queried the International Quality
and Value Institute Advisors (IQVIA) National Prescription Audit (NPA)
and the Medical Expenditures Panel Survey (MEPS). We report the number
and percentage of prescriptions for sulfonylureas, biguanides, insulin,
thiazolidinediones, dipeptidyl peptidase-4 inhibitors, GLP-1 receptor
agonists, SGLT-2 inhibitors, and antidiabetic combinations. When
available, we also stratified by several sociodemographic variables,
including sex, age, race, education, insurance, and income.

**Results:** Biguanides represented approximately 50% of the
antihyperglycemic medication prescriptions, followed by insulins (NPA:
25.1%, MEPS: 20.8%). Analog insulins in the fast-acting and long-acting
categories are the most prescribed insulin types. For most classes of
medications, estimates from the two datasets were similar. However,
there was a large discrepancy in the estimated number of prescriptions
for bolus analog insulins (26.7 million from NPA and 41.6 million from
MEPS). The largest discrepancies were among the insurance groups, with
estimated percentages differing by as much as 22 percentage points.

**Conclusions:** Both datasets report similar prescription fill patterns
to other studies. Either dataset may be suitable for exploring overall
trends, or estimates stratified by age or sex.

\pagebreak

# Introduction

As new medications emerge and prescribing practices evolve,
understanding trends in diabetes medication usage is crucial for public
health interventions, healthcare policy, and clinical practice.
Surveillance programs may have access to more than one data source for
the purpose of evaluating diabetes medication prescription or usage,
such as electronic health records, insurance claims, publicly available
national surveys such as the Medical Expenditures Panel Survey (MEPS),
or proprietary databases such as the International Quality and Value
Institute Advisors (IQVIA) National Prescription Audit (NPA) [@availabl;
@MEPSdocumentation; @lee2021]. These data sources employ different methodologies to collect and capture information from potentially non-overlapping segments of the healthcare system, with varying estimates and insights [@defever2024; @tran2020].

Research which directly compares prescription patterns captured in MEPS and IQVIA NPA on diabetes medication use is limited. The accuracy of MEPS prescription data has been evaluated in comparison with 2006 and 2007 Medicare Part D claims [@hill2011], with high concordance between the two datasets; when estimates differed, it was usually because respondents underreported the number of different drugs taken but overreported the number of fills 
[@hill2011]. These discrepancies were consistent across most
sociodemographic groups [@hill2011]. 

IQVIA NPA has been used in combination with data on internet searches for SGLT-2i and GLP-1RA to estimate the correlation between actual prescription rates and the frequency with which these medications were searched [@dzaye2022]. It has also been used to estimate monthly prescriptions of these medications and how these more granular time trends vary by different clinician specialties [@adhikari2022].The completeness of IQVIA NPA in capturing the use of oral anti-cancer medications was evaluated by linking these data with the Surveillance, Epidemiology, and End Results (SEER) program from 2006 to 2012 
[@tran2020]. Only 67% of cases in the SEER program had matches in the IQVIA NPA database, likely because oral anti-cancer medications were provided through specialty pharmacies not covered by IQVIA [@tran2020]

This study estimated the number and type of antihyperglycemic medication prescriptions in the US during 2020-2021. We also performed a comparative analysis of IQVIA NPA and MEPS, overall and by subgroups that are shared between the two datasets. While MEPS is freely available to the public for exploration, IQVIA NPA requires payment to access; such a comparison may help inform future research where the cost is a consideration.

# Research Design and Methods

## Data Sources

We used two sources: IQVIA NPA and MEPS, which provide the number of prescriptions for various classes of medications [@iqvia; @iqvia2024; @MEPSdocumentation]. IQVIA NPA covers approximately 90% of prescriptions dispensed in U.S. pharmacies; it provides information on the medical specialty of the provider, whereas the information on consumer sociodemographic, behavioral, and other key characteristics is limited. MEPS is a nationally representative data source that collects self-reported information on prescription fills from households in addition to sociodemographic and behavioral variables, educational attainment, and ratio of the family income to poverty line (poverty income ratio) of the individual that IQVIA NPA does not provide.

We queried drug prescriptions from NPA for January 2020 – December 2021.
NPA receives over 3 billion prescription claims per year nationwide [@iqvia; @iqvia2024]. Of these, 90% are retail, 77% mail orders, and 72% from long-term care pharmacies [@iqvia]. For this analysis, we excluded long-term care pharmacies to make estimates comparable to the non-institutionalized population from MEPS. We also restricted the analysis to adults 18 years of age and older. We used 2020–2021 MEPS data from the Agency for Healthcare Research and Quality, accessed through IPUMS [@MEPSdocumentation; @blewett2023ipums].The MEPS survey is administered to a nationally representative subsample of households surveyed in the National Health Interview Survey, and is representative of non-institutionalized population in the U.S. IPUMS provides a harmonized version of MEPS data that standardizes variable names and coding through time [@blewett]. These study years were chosen to include the most recently available data and capture newer medications.

MEPS prescription medication records provide data on self-reported prescribed medicines; each record represents one household-reported medicine purchased or otherwise obtained in a year. Participants were asked to supply the names of prescribed medicines, the reason for the prescription, the number of times the prescription was obtained, and the names and locations of pharmacies that filled the prescriptions. MEPS also collects data from the corresponding pharmacies on the strength, quantity, and days of supplied medications. The analyses of antidiabetic drugs was restricted to the population with diabetes, resulting in a dataset of 27,005 records of medication purchases for 2,373 adults.

## Statistical Analysis

The outcome of interest was prevalence patterns of antihyperglycemic prescription drugs purchased among adults with diabetes. Generic medications included sulfonylureas, biguanides, insulin, thiazolidinediones (TZD), dipeptidyl peptidase-4 inhibitors (DPP-4i), GLP-1RA, SGLT2i, and combinations thereof. Antidiabetic drug combinations in MEPS were recorded as the constitutive drug classes (e.g., a record for glyburide-metformin was split into a record for sulfonylureas and a record for biguanides). We used the provided generic drug names and medicine names to further classify insulin records into basal, bolus, or pre-mixed and human or analog categories. Generic drug names that conflicted with the self-reported drug name were classified as “unknown”. Analysis of MEPS accounted for complex survey weights and pooled data for two years [@MEPSdocumentation]. We used the estimated number of prescriptions for each drug type to estimate what percentage of the total number of prescriptions for which they accounted. For the different types of insulins, we calculated the percentage of total insulin prescriptions for which they accounted.

All estimates were age-adjusted using direct standardization and standardized to the 2000 U.S. population for ages 18–39, 40–59, 60–64, 65–74, and ≥75 years. We present these estimates overall and stratified by sex, age, type of health insurance coverage, and copay amount. Each dataset contains stratifying variables unique to those data. MEPS results were suppressed if the nominal or effective sample size was less than 10 or if the relative width of the 95% confidence interval was greater than 160%, as these were deemed statistically unreliable.

We also calculated the relative difference between IQVIA NPA and MEPS prevalence estimates of prescriptions, overall and by variables that both datasets had in common. Because IQVIA NPA estimates are weighted according to proprietary weighting methods applied by IQVIA and the large sample size of IQVIA NPA and the coverage of its population, we treat IQVIA NPA estimates as census estimates with negligible variance. If the 95% confidence interval for the MEPS estimate did not contain the estimate from IQVIA NPA, the two estimates were considered significantly different.

# Results

## Insulin Prescriptions

The total number of dispensed insulin prescriptions estimated from NPA was 84,559,000 and from MEPS was 114,659,000 (Table 1). In both datasets, bolus analog insulins were the most dispensed bolus insulin, with NPA estimating 26.7 million and MEPS estimating 41.6 million dispensations. Similarly, basal analog insulins were the most dispensed basal insulin, but the estimates were much closer, totaling 48.7 million from NPA and 58.5 million from MEPs.

Based on estimates from NPA, insulins of any kind and overall were more frequently dispensed in women than men, but this trend was reversed in estimates from MEPS (Table 1). Almost 90% of those receiving human bolus insulin were 40 years old or older, and 80% of those receiving bolus analog insulin were 40 years old or older. The uninsured population represented less than 1% of those receiving insulin, with most of these patients receiving bolus human insulin. Estimates from MEPS for race, education, and poverty were suppressed for many insulin
medications (Table 1). Over half of those receiving analog bolus, analog basal, and pre-mixed insulins were non-Hispanic White people. Approximately 80% of those same insulins were prescribed to people with a high school education or higher (Table 1). Thirty percent of analog bolus insulins were prescribed to people in the low income category, compared to 26.2% analog basal insulins and pre-mixed insulins (Table 1). Estimated total number of dispensed insulins from each dataset for the stratifying variables are available in supplementary Table S1.

The largest differences between datasets were seen in the dispensation of bolus analog and basal analog categories (Figure 1). The bolus analog dispensation in MEPS was 
`r specifyDecimal(comparePercents(wide_insulin_data, 'Bolus/Analog', 'MEPS'), 1)`
percentage points higher than in NPA, representing almost double the number of prescriptions than those reported in NPA. In contrast, percentage of basal analog dispensed was
`r specifyDecimal(abs(comparePercents(wide_insulin_data, 'Basal/Analog', 'MEPS')), 1)`
percentage points lower in MEPS than NPA. For the remaining insulin groups, MEPS generally reported similar, although often lower percentages. Based on the information provided by MEPS, 
`r specifyDecimal(pull(filter(wide_insulin_data, Prescription == 'Insulin/Unknown'), MEPS), 1)`%
of insulin dispensed could not be categorized.

Among the stratifying variables, the largest discrepancy between
datasets was observed for the insurance groups (Figure 2A). For example,
the MEPS estimates were between
`r specifyDecimal(abs(range(heatmap_data$perc_diff[heatmap_data$group== 'Public only' & heatmap_data$insulin_indicator == 'insulin'], na.rm = TRUE)[2]), 1)`
and
`r specifyDecimal(abs(range(heatmap_data$perc_diff[heatmap_data$group== 'Public only' & heatmap_data$insulin_indicator == 'insulin'], na.rm = TRUE)[1]), 1)`
percentage points higher for all categories of insulin among those with
public insurance, while NPA estimates were as much as
`r specifyDecimal(abs(range(heatmap_data$perc_diff[heatmap_data$group== 'Any private' & heatmap_data$insulin_indicator == 'insulin'], na.rm = TRUE)[2]), 1)`
percentage points higher for all insulin dispensed among those with
private insurance. 

The magnitude of the differences in estimates between the two data
sources were smaller for the age and sex groups than the insurance
groups (Figure 2A). Estimates among the age groups ranged from
`r specifyDecimal(abs(range(heatmap_data$perc_diff[heatmap_data$stratifier == 'Age' & heatmap_data$insulin_indicator == 'insulin'], na.rm = TRUE)[1]), 1)`
percentage points higher for MEPS (bolus analog dispensed for those aged
60–74) to
`r specifyDecimal(abs(range(heatmap_data$perc_diff[heatmap_data$stratifier == 'Age' & heatmap_data$insulin_indicator == 'insulin'], na.rm = TRUE)[2]), 1)`
percentage points higher for NPA (all insulins estimate for adults aged
40–59). Within the sex groups, only the estimated percentage from NPA
for all insulins for females was
`r specifyDecimal(heatmap_data$perc_diff[heatmap_data$group == 'Female' & heatmap_data$Prescription == 'All insulins'], 1)`
percentage points higher than the same estimate from MEPS.

## Non-insulin hypoglycemic prescriptions

In general, NPA and MEPS estimates of the total number of non-insulin
medications were more similar than the estimates for insulins (Table 2). Biguanides were the most-dispensed non-insulin medication. Both datasets estimated over 75% of patients paid a $10 or less copay for dispensed biguanides and people age 60 or older received the majority of dispensed biguanides (Table 2). Sulfonylureas were the second most commonly dispensed
diabetes medications (16.4%) and patients over 60 years old received 64% of dispensed sulfonylureas. Men were more frequently dispensed sulfonylureas, TZD, and SGLT2i than women. Thiazolidinediones were the least commonly
dispensed (3.5%) and of those taking that class of medication, 58.3%
were male, 64.6% were ≥60 years of age, and 63.7% paid ≤ \$10. DPP-4i
were the second least commonly dispensed medication (8.7%). Females received more GLP-1RAa dispensations than men (54.4%) and people with private
insurance were dispensed 69.7% of the estimated GLP1-RAs. Endocrinologists
prescribed 18.7% of the GLP1-RA dispensed, a higher percentage than any
of the other diabetes medication classes, with the exception of insulin. Estimates from MEPS showed that over 50% of all non-insulin medications, except TZD, were prescribed to non-Hispanic White people (Table 2). Among the different education groups, those
with a greater than high school education accounted for more than 50% of
all non-insulin medications except for TZD, of which 51.2% were
prescribed to those with a high school education (Table 2). Among the
different poverty income ratio categories, more than 50% of
prescriptions for all non-insulin medication classes were to people with
middle income or higher (\>200%) (Table 2). Estimated totals of insulins
for the different stratifying variables from each dataset are available
in supplementary Table S2.

Non-insulin medication percentages were similar for both NPA and MEPS
across many drug categories (Figures 1B & 2B). As with the insulin
medications,
`r specifyDecimal(pull(filter(wide_not_insulin, Prescription == 'Unknown'), MEPS), 1)`%
of non-insulin medications could not be classified. The largest
discrepancy in the percentage of non-insulin medications was observed among the insurance groups (Figure 2B). Within
the insurance groups, the discrepancies ranged from
`r specifyDecimal(abs(range(heatmap_data$perc_diff[heatmap_data$stratifier == 'Insurance' & heatmap_data$insulin_indicator == 'not insulin'], na.rm = TRUE)[1]), 1)`
percentage points higher for MEPS (TZD estimate for those on public only
insurance) to
`r specifyDecimal(abs(range(heatmap_data$perc_diff[heatmap_data$stratifier == 'Insurance' & heatmap_data$insulin_indicator == 'not insulin'], na.rm = TRUE)[2]), 1)`
percentage points higher for NPA (TZD estimate for those on any private
insurance). For eight of the 14
insurance by non-insulin medication groups where MEPS estimates were
available, the MEPS estimate was lower. Among the copay groups, MEPS estimates were higher for nine
of the 31 copay by non-insulin medication groups. The differences for
copay groups ranged from
`r specifyDecimal(abs(range(heatmap_data$perc_diff[heatmap_data$stratifier == 'Copay' & heatmap_data$insulin_indicator == 'not insulin' ], na.rm = TRUE)[2]), 1)`
to
`r specifyDecimal(abs(range(heatmap_data$perc_diff[heatmap_data$stratifier == 'Copay' & heatmap_data$insulin_indicator == 'not insulin'], na.rm = TRUE)[1]), 1)`
percentage points higher for NPA and MEPS, respectively. The percentage of adults with no copay purchasing TZD was 16.5 percentage points higher in the MEPS data (Figure 2b).

The age group with the largest difference was the estimate for GLP-1RA
for adults aged 40–59, which had an NPA estimate that was
`r specifyDecimal(abs(range(heatmap_data$perc_diff[heatmap_data$stratifier == 'Age' & heatmap_data$insulin_indicator == 'not insulin'], na.rm = TRUE)[2]), 1)`
percentage points higher than the MEPS estimate (Figure 2B). The largest
difference was the percentage of adults aged 75 or greater dispensed sulfonylureas, which was `r specifyDecimal(abs(range(heatmap_data$perc_diff[heatmap_data$stratifier == 'Age' & heatmap_data$insulin_indicator == 'not insulin'], na.rm = TRUE)[1]), 1)`
percentage points higher in MEPS than the NPA estimate. NPA estimates were
higher among adults aged 40–59 dispensed biguanides and GLP-1RA. The estimates
for non-insulin medications dispensed within the sex groups followed
similar patterns to the insulin estimates: all of the values for females
were higher in the NPA dataset, while estimates for males were higher in
the MEPS dataset, although only the estimated 95% confidence interval
for GLP-1RA in the MEPS data excluded the NPA estimate.

# Discussion

This study evaluated patterns of antihyperglycemic prescriptions from both NPA and MEPS as sources of national data on antihyperglycemic prescriptions during 2020–2021. Biguanides were the most commonly prescribed antihyperglycemic medication in both data sources, followed by insulins. Analog insulins in both the fast-acting and long-acting categories are the most prescribed insulin types. These results are in-line with findings from other studies; in one study using 2008–2015 data from MEPS , biguanides were the most commonly prescribed class of antihyperglycemic medications overall, accounting for approximately 59% in 2015 [@raval2020]. A study of ambulatory
insulin treatment using data from IQVIA's National Disease and
Therapeutic Index reported that analog insulins were the most common
insulin treatment, accounting for 92% of the treatment visits during
that time frame [@sarkar2021].

Both datasets reported relatively similar estimated numbers and
percentages for most anithyperglycemic prescriptions in the U.S,
particularly overall, and among age and sex groups. However, a large
difference in the estimated total number of insulins prescribed was
identified, driven primarily by the discrepancy in the estimated number
of both types of analog insulin prescriptions for those with public
insurance only. For most drug classes, not just analog insulins,
estimates were the most different among insurance group. For all drug
classes where MEPS data were available, the number of prescriptions for
those with public only insurance was as much as 22 percentage points
higher, depending on the drug class being evaluated, than the
corresponding NPA estimate, while the opposite was true for those on any
private insurance. These estimates may differ because NPA may not
capture medicines filled through pharmacies dispensing from hospitals or
clinics, especially those associated with public health insurance, such
as Veterans Health Administration pharmacies, or other specialty
pharmacies [@defever2024; @hill2011]. Another study found that NPA only
captured 59% of those who were uninsured, 67% of those with private
insurance, and 74% of those on Medicaid who were in the SEER data on
patients using oral anticancer medications [@tran2020].

Differences between the two data sources may be explained in-part due to
methodological differences in how the data are collected. Data on
prescriptions to MEPS is largely self-reported, and self-reported data
on number of fills and refills from surveys are subject to
misclassification. Respondents tend to over report the number of fills
and under report the total number of medications, although reporting
accuracy was generally high for maintenance drugs taken for chronic
conditions [@hill2011]. Additionally, the accuracy of reporting may vary
among different groups, as high health care consumers have been shown to
under report prescriptions and respondents with lower literacy are often
inconsistent in reporting [@ritter2001; @schönfeld2021]. However, other
studies have shown that inaccuracies in MEPS tend to be consistent
across different socioeconomic and demographic groups and therefore have
minimal impact on the evaluation of behavioral factors that contribute
to differences in medication usage [@hill2011]. While MEPS does include
data on the number of fills and quantity dispensed, these data may
contain imputed values if complete records are missing or were not
provided, and this may introduce some bias in estimating the total
number of fills. An investigation of the representativeness and
completeness of the NPA database for studying oral anticancer medication
found that only 67% of cases in the SEER program had matches in the NPA
database, and this varied by subgroup. In particular, NPA only captured
61% of males, 59% of non-Hispanic Black patients, and 62% of Hispanic
patients in the SEER program, although this may be due in part to oral
anticancer medication prescriptions being filled by specialty pharmacies
[@tran2020].

When considering these data sources for use in future analyses, it may
be beneficial to consider them together, when possible, or to consider
which is better suited to the question at hand. Because MEPS data are
available at the patient-level, they can provide insights into
patient-level factors that may influence prescription trends. MEPS also
has the advantage of providing data on race/ethnicity of individuals,
which can allow exploration of racial disparities in diabetes medication
usage. Previous studies have shown that racial disparities in diabetes
medication prescription and use exist, and MEPS can be a valuable tool
in tracking these disparities [@chehal2023; @bepo2024; @eberly2021]. NPA
covers 90% of retail pharmacies in the U.S. and may be better for
identifying national trends and patterns in fills by these pharmacies.
Incorporating both datasets may help triangulate and validate findings.

## Limitations

MEPS data is subject to the limitations of survey data, some of which
have already been described, such as subject recall bias or mistakes in
reporting. Additionally, there has been a steadily declining response
rate for MEPS over time. In 2008, the response rate was 59.3% and this
fell to 27.6% in 2020 and fell further to 21.8% in 2021. Although
non-response can be adjusted for in the design of weights, it is not
possible to know how non-response has biased the survey. We assumed that
all prescriptions reported by NPA were for treatment of diabetes,
although this may not be the case.

Furthermore, the populations covered for NPA and MEPS are not identical.
NPA has high coverage of retail pharmacies with relatively small
variance estimates, while MEPS estimates come from a much smaller sample
of the non-institutionalized population, with correspondingly larger
variance estimates. However, MEPS medications are reported by all
household members, so all outpatient dispensing settings should be
included. Despite these differences in populations, the majority of
estimates that could be compared were similar, suggesting that these
datasets cover similar populations by age and sex. Lastly, the
proprietary methods NPA uses to produce their estimates are also a
potential source for differences between the two datasets, but it is not
possible to evaluate their impact.

# Conclusions

Overall, the estimated number and percentage of antihyperglycemic
medications from both NPA and MEPS are comparable, with the exception of
the large difference in the estimated number of bolus analog insulin
prescriptions. Each dataset provides a different set of variables that
prescriptions may be stratified by, and the use of a particular dataset
should match the research questions being asked. Either dataset may be
appropriate for overall trends, or trends stratified by age and sex, as
these were generally consistent. However, large differences between the
estimates were found when the estimates were stratified by insurance
group. Because MEPS provides socioeconomic demographic data, such as
race/ethnicity and highest educational attainment, it is better suited
to addressing questions related to disparities in the prescription of
antihyperglycemic medications. NPA provides data on the provider
specialty, while also providing a larger coverage of the retail universe
that should make it less prone to fluctuations in sample size. When
possible, using both datasets may help to triangulate and validate
findings, providing a more comprehensive understanding of trends and
patterns in antihyperglycemic medication use.

# Acknowledgements

*Funding:* The authors report no funding sources.

*Conflict of Interest:* The authors of this study declare no conflicts
of interest.

# References

::: {#refs}
:::

\pagebreak

::: landscape
# Tables

```{r}
tar_load(compare_insulins_gt)
tar_load(compare_not_insulins_gt)
```

```{r}
#| label: tbl-insulin
#| tbl-cap: "Weighted estimates from IQVIA National Prescription Audit and the Medical Expenditure Panel Survey from 2020–2021 for age-adjusted number of prescriptions for different categories of insulin, adults with diabetes in the United States. "
compare_insulins_gt 
gtsave(compare_insulins_gt, here::here('manuscript/output/table1.docx'))
```

\pagebreak

```{r}
#| label: tbl-not_insulin
#| tbl-cap: "Weighted estimates from IQVIA National Prescription Audit and the Medical Expenditure Panel Survey from 2020–2021 for age-adjusted number of prescriptions for non-insulin medications and all insulins used in the management of diabetes, adults with diabetes in the United States."
compare_not_insulins_gt 
gtsave(compare_not_insulins_gt, here::here('manuscript/output/table2.docx'))
```

\pagebreak
:::

# Figures

Figure 1: Comparison of A) estimated percentage of insulin prescriptions by type of insulin and B) estimated percentage of all diabetes prescriptions by type of non-insulin medication in the USA, NPA and MEPS 2020–2021.

```{r}
tar_load(meps_iqvia_plots,
         store = here::here('_targets/'))
fig1 <- meps_iqvia_plots +
  plot_annotation(tag_levels = 'A') &
  theme(plot.caption = element_text(hjust = 0))
ggsave(here::here('manuscript/output/fig1.png'),
       fig1,
       width = 8,
       heigh = 8)
```

Figure 2: Heatmap showing the differences between NPA and MEPS in the
estimated percentages of each type of medication out of A) the total
number of insulin prescriptions and B) the total number of prescriptions
for diabetes medications, overall and among different stratifying
variables in the USA, 2020–2021. Grey cells indicate that the MEPS
estimate was suppressed. Asterisks denote estimates where the 95%
confidence interval for the estimated percentage from MEPS did not
include the estimated percentage from NPA.

```{r}
fig2 <- wrapped_heatmap +
  plot_annotation(tag_levels = 'A') &
  theme(plot.caption = element_text(hjust = 0))
ggsave(here::here('manuscript/output/fig2.png'),
       fig2,
       width = 8,
       height = 8)
```
